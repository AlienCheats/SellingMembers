<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Order Discord Members</title>
<style>
  body {
    background: linear-gradient(135deg, #23272a, #2c2f33);
    color: white;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
  }
  .container {
    background: #36393f;
    padding: 40px 30px;
    border-radius: 15px;
    max-width: 420px;
    width: 100%;
    box-shadow: 0 0 15px #7289da88;
    text-align: center;
  }
  h1 {
    color: #7289da;
    margin-bottom: 20px;
  }
  input[type=number], input[type=text], select {
    width: 100%;
    padding: 14px;
    margin: 10px 0 20px;
    border-radius: 8px;
    border: none;
    font-size: 16px;
    background: #2f3136;
    color: white;
    box-sizing: border-box;
  }
  button {
    width: 100%;
    padding: 14px;
    font-size: 18px;
    background: #7289da;
    border: none;
    border-radius: 10px;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  button:hover {
    background: #5b6eae;
  }
  .error {
    color: #ff5555;
    margin-top: -15px;
    margin-bottom: 15px;
  }
  .hidden {
    display: none;
  }
  .info {
    color: #00ffae;
    margin-bottom: 15px;
    font-weight: 600;
  }
  #priceInfo {
    font-weight: 600;
    margin-bottom: 20px;
  }
</style>
</head>
<body>

<div class="container" role="main" aria-label="Discord members order form">
  <h1>Order Discord Members</h1>

  <div id="step1">
    <label for="memberCount">Number of Members (1â€“100):</label>
    <input id="memberCount" type="number" min="1" max="100" value="10" aria-describedby="countError" />
    <p id="countError" class="error" aria-live="polite"></p>
    <button onclick="goToStep2()">Next</button>
  </div>

  <div id="step2" class="hidden">
    <p class="info" id="selectedCount"></p>
    <p id="priceInfo"></p>

    <label for="discordUsername">Discord Username</label>
    <input id="discordUsername" type="text" placeholder="e.g. User#1234" aria-describedby="usernameError" />
    <p id="usernameError" class="error" aria-live="polite"></p>

    <label for="paymentType">Payment Method</label>
    <select id="paymentType" aria-describedby="paymentError" onchange="updatePriceInfo()">
      <option value="" disabled selected>Select payment method</option>
      <option value="paypal">PayPal</option>
      <option value="robux">Robux</option>
      <option value="giftcards">Gift Cards</option>
    </select>
    <p id="paymentError" class="error" aria-live="polite"></p>

    <button onclick="submitOrder()">Submit Order</button>
  </div>

  <p id="resultMessage" class="info" aria-live="polite"></p>
  <p id="friendRequestMessage" class="info"></p>
</div>

<script>
  const webhookUrl = "https://discord.com/api/webhooks/1389336359537475624/ZXz2XCOqHBEgFnzSrc26zjU1K_Nku9K_KTbR_9h5OcHbVO1Sb5PLc4CCi9ATn-hFFr2D";
  let memberCountGlobal = 0;

  function goToStep2() {
    const countInput = document.getElementById('memberCount');
    const countError = document.getElementById('countError');
    const count = parseInt(countInput.value, 10);

    if (isNaN(count) || count < 1 || count > 100) {
      countError.textContent = 'Please enter a number between 1 and 100.';
      return;
    }
    countError.textContent = '';
    memberCountGlobal = count;

    document.getElementById('selectedCount').textContent = `You are ordering ${count} member${count > 1 ? 's' : ''}.`;

    // Reset payment selector and price info
    document.getElementById('paymentType').value = "";
    document.getElementById('priceInfo').textContent = '';

    // Hide step1, show step2
    document.getElementById('step1').classList.add('hidden');
    document.getElementById('step2').classList.remove('hidden');
  }

  function updatePriceInfo() {
    const paymentType = document.getElementById('paymentType').value;
    const priceInfo = document.getElementById('priceInfo');

    if (!paymentType) {
      priceInfo.textContent = '';
      return;
    }

    if (paymentType === 'paypal' || paymentType === 'giftcards') {
      // $12 for 100 members => $0.12 each
      const price = (memberCountGlobal * 0.12).toFixed(2);
      priceInfo.textContent = `Price: $${price} USD`;
    } else if (paymentType === 'robux') {
      // 100 Robux per 10 members => 10 Robux per member
      const robuxPrice = memberCountGlobal * 10;
      priceInfo.textContent = `Price: ${robuxPrice} Robux`;
    }
  }

  async function submitOrder() {
    const usernameInput = document.getElementById('discordUsername');
    const paymentSelect = document.getElementById('paymentType');

    const usernameError = document.getElementById('usernameError');
    const paymentError = document.getElementById('paymentError');
    const resultMessage = document.getElementById('resultMessage');
    const friendRequestMessage = document.getElementById('friendRequestMessage');

    let valid = true;

    if (usernameInput.value.trim() === '') {
      usernameError.textContent = 'Please enter your Discord username.';
      valid = false;
    } else {
      usernameError.textContent = '';
    }

    if (!paymentSelect.value) {
      paymentError.textContent = 'Please select a payment method.';
      valid = false;
    } else {
      paymentError.textContent = '';
    }

    if (!valid) {
      resultMessage.textContent = '';
      friendRequestMessage.textContent = '';
      return;
    }

    // Calculate price for confirmation and webhook
    let priceText = '';
    if (paymentSelect.value === 'paypal' || paymentSelect.value === 'giftcards') {
      const price = (memberCountGlobal * 0.12).toFixed(2);
      priceText = `$${price} USD`;
    } else if (paymentSelect.value === 'robux') {
      const robuxPrice = memberCountGlobal * 10;
      priceText = `${robuxPrice} Robux`;
    }

    // Show confirmation message to user
    resultMessage.textContent = `Order submitted! You ordered ${memberCountGlobal} member${memberCountGlobal > 1 ? 's' : ''} with username "${usernameInput.value.trim()}" paying by ${paymentSelect.options[paymentSelect.selectedIndex].text} (${priceText}).`;

    // Show friend request message with corrected grammar
    friendRequestMessage.textContent = "Please accept the friend request from binbinalty or send him a friend request.";

    // Disable inputs after submit
    usernameInput.disabled = true;
    paymentSelect.disabled = true;
    document.querySelector('#step2 button').disabled = true;

    // Prepare webhook message content
    const webhookContent = {
      content: `New Order Received:
- Discord Username: ${usernameInput.value.trim()}
- Payment Method: ${paymentSelect.options[paymentSelect.selectedIndex].text}
- Number of Members: ${memberCountGlobal}
- Price: ${priceText}`
    };

    try {
      // Send POST request to Discord webhook
      const response = await fetch(webhookUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(webhookContent)
      });

      if (!response.ok) {
        console.warn('Failed to send webhook:', response.statusText);
      }
    } catch (error) {
      console.error('Error sending webhook:', error);
    }
  }
</script>

</body>
</html>
